
# from dependencies import *

from tensorflow.keras.models import Model
from tensorflow.keras.layers import InputLayer, Input, TimeDistributed, ConvLSTM2D, BatchNormalization, Flatten, Dense, Dropout, GlobalAveragePooling2D, Lambda, Conv3D, MaxPooling3D
from tensorflow.keras.applications import inception_v3
from tensorflow.keras.applications import mobilenet
from tensorflow.keras.applications import vgg16
from tensorflow.keras.applications import resnet_v2
from tensorflow.keras.applications import densenet
from tensorflow.keras.applications import xception

"""# **Constants and utility functions**"""

class LayerWrapper:
  @staticmethod
  def flatten():
    def wrapper():
      return Flatten()
    return wrapper


  @staticmethod
  def global_average_pooling():
    def wrapper():
      return GlobalAveragePooling2D()
    return wrapper


  @staticmethod
  def dropout(dropout_rate=0.5):
    def wrapper():
      return Dropout(dropout_rate)
    return wrapper


  @staticmethod
  def dense(units=1, activation='sigmoid'):
    def wrapper():
      return Dense(units=units, activation=activation)
    return wrapper


class BackboneWrapper:
  @staticmethod
  def inceptionV3_wrapper(input_shape, include_top=False, weights='imagenet'):
    def inceptionV3():
      return inception_v3.InceptionV3(input_shape=input_shape, include_top=include_top, weights=weights)
    return inception_v3.preprocess_input, inceptionV3


  @staticmethod
  def mobilenet_wrapper(input_shape, include_top=False, weights='imagenet'):
    def mobile_net():
      return mobilenet.MobileNet(input_shape=input_shape, include_top=include_top, weights=weights)
    return mobilenet.preprocess_input, mobile_net
  

  @staticmethod
  def vgg16_wrapper(input_shape, include_top=False, weights='imagenet'):
    def vgg_16():
      return vgg16.VGG16(input_shape=input_shape, include_top=include_top, weights=weights)
    return vgg16.preprocess_input, vgg_16


  @staticmethod
  def resnet152v2_wrapper(input_shape, include_top=False, weights='imagenet'):
    def res_net_v2():
      return resnet_v2.ResNet101V2(input_shape=input_shape, include_top=False, weights='imagenet')
    return resnet_v2.preprocess_input, res_net_v2
  
  
  @staticmethod
  def densenet121_wrapper(input_shape, include_top=False, weights='imagenet'):
    def dense_net():
      return densenet.DenseNet121(input_shape=input_shape, include_top=False, weights='imagenet')
    return densenet.preprocess_input, dense_net

  @staticmethod
  def xception_wrapper(input_shape, include_top=False, weights='imagenet'):
    def x_ception():
      return xception.Xception(input_shape=input_shape, include_top=include_top, weights=weights)
    return xception.preprocess_input, x_ception

class BackboneInfo:
  def __init__(self, name, fpr, tpr, tresholds, auc):
    self.name = name
    self.fpr = fpr
    self.tpr = tpr
    self.tresholds = tresholds
    self.auc = auc

CONFIG_DICT = {
  "backbones": {
    "additional_layers": [LayerWrapper.flatten(), LayerWrapper.dense(4, 'softmax')], # 1, sigmoid
    "last_layer_trainable_count": 5,
    "inceptionv3": {
      "name": "inception",
      "input_size": (256, 256),
      "wrapper": BackboneWrapper.inceptionV3_wrapper
    },
    "mobilenet": {
      "name": "mobilenet",
      "input_size": (224, 224),
      "wrapper": BackboneWrapper.mobilenet_wrapper
    },
    "vgg16": {
      "name": "vgg16",
      "input_size": (224, 224),
      "wrapper": BackboneWrapper.vgg16_wrapper
    },
    "resnet152v2": {
      "name": "resnet152v2",
      "input_size": (224, 224),
      "wrapper": BackboneWrapper.resnet152v2_wrapper
    },
    "densenet121": {
      "name": "densenet121",
      "input_size": (224, 224),
      "wrapper": BackboneWrapper.densenet121_wrapper
    },
    "xception": {
      "name": "xception",
      "input_size": (299, 299),
      "wrapper": BackboneWrapper.xception_wrapper
    },
    "info": [
      BackboneInfo(
        "Res-Net+CBAM+ConvLSTM",
        [0.0, 0.0, 0.0, 0.006666666666666667, 0.006666666666666667, 0.013333333333333334, 0.013333333333333334, 0.013333333333333334, 0.013333333333333334, 0.02, 0.02, 0.02666666666666667, 0.02666666666666667, 0.03333333333333333, 0.03333333333333333, 0.04, 0.04, 0.04666666666666667, 0.04666666666666667, 0.05333333333333334, 0.05333333333333334, 0.06, 0.06, 0.06666666666666667, 0.06666666666666667, 0.08, 0.08, 0.08666666666666667, 0.08666666666666667, 0.10666666666666667, 0.10666666666666667, 0.12, 0.12, 0.12666666666666668, 0.12666666666666668, 0.13333333333333333, 0.13333333333333333, 0.14666666666666667, 0.14666666666666667, 0.16666666666666666, 0.16666666666666666, 0.17333333333333334, 0.17333333333333334, 0.18, 0.18, 0.18666666666666668, 0.18666666666666668, 0.2, 0.2, 0.21333333333333335, 0.21333333333333335, 0.24, 0.24, 0.26, 0.26, 0.2733333333333333, 0.2733333333333333, 0.28, 0.28, 0.2866666666666667, 0.2866666666666667, 0.31333333333333335, 0.31333333333333335, 0.38666666666666666, 0.38666666666666666, 0.4066666666666667, 0.4066666666666667, 0.44666666666666666, 0.44666666666666666, 0.46, 0.46, 0.5, 0.5, 0.64, 0.64, 0.6733333333333333, 0.6733333333333333, 0.6866666666666666, 0.6866666666666666, 0.7533333333333333, 0.7533333333333333, 1.0],
        [0.0, 0.006666666666666667, 0.06666666666666667, 0.06666666666666667, 0.09333333333333334, 0.09333333333333334, 0.1, 0.11333333333333333, 0.20666666666666667, 0.20666666666666667, 0.22, 0.22, 0.3333333333333333, 0.3333333333333333, 0.36666666666666664, 0.36666666666666664, 0.37333333333333335, 0.37333333333333335, 0.38666666666666666, 0.38666666666666666, 0.4266666666666667, 0.4266666666666667, 0.5733333333333334, 0.5733333333333334, 0.66, 0.66, 0.68, 0.68, 0.7, 0.7, 0.7266666666666667, 0.7266666666666667, 0.7333333333333333, 0.7333333333333333, 0.78, 0.78, 0.7866666666666666, 0.7866666666666666, 0.8, 0.8, 0.82, 0.82, 0.8266666666666667, 0.8266666666666667, 0.84, 0.84, 0.8533333333333334, 0.8533333333333334, 0.88, 0.88, 0.8866666666666667, 0.8866666666666667, 0.9, 0.9, 0.9066666666666666, 0.9066666666666666, 0.9133333333333333, 0.9133333333333333, 0.92, 0.92, 0.9333333333333333, 0.9333333333333333, 0.94, 0.94, 0.9466666666666667, 0.9466666666666667, 0.9533333333333334, 0.9533333333333334, 0.96, 0.96, 0.9666666666666667, 0.9666666666666667, 0.9733333333333334, 0.9733333333333334, 0.98, 0.98, 0.9866666666666667, 0.9866666666666667, 0.9933333333333333, 0.9933333333333333, 1.0, 1.0],
        [1.9994905, 0.9994905, 0.99814236, 0.99812526, 0.9979742, 0.99790335, 0.9978067, 0.99771, 0.9963477, 0.99605477, 0.99528223, 0.9952559, 0.9933013, 0.9930875, 0.9922077, 0.9920536, 0.9919254, 0.9917734, 0.9910143, 0.99027807, 0.9882116, 0.9881131, 0.97923285, 0.9773951, 0.96800363, 0.96565485, 0.9594269, 0.9573086, 0.9527225, 0.9411768, 0.91618717, 0.90917885, 0.8997453, 0.8979212, 0.83669317, 0.81804883, 0.7748755, 0.7367966, 0.70284784, 0.6684774, 0.587813, 0.5495332, 0.545208, 0.5182543, 0.4701443, 0.46708882, 0.45239776, 0.41582412, 0.35756642, 0.29468516, 0.29112616, 0.24802552, 0.22997862, 0.17463288, 0.16344589, 0.14129464, 0.12329838, 0.121027976, 0.11315938, 0.108301446, 0.089997314, 0.06789678, 0.0658512, 0.03121523, 0.030481301, 0.023326967, 0.019572265, 0.014653193, 0.014361963, 0.013116166, 0.012953713, 0.011050384, 0.010985777, 0.0061848424, 0.005241437, 0.0046034744, 0.004598875, 0.0042292513, 0.0042116963, 0.0029777677, 0.0029405484, 0.00020858971],
        0.896888888888889),
      BackboneInfo(
        "Res-Net+SE+ConvLSTM",
        [0.0, 0.0, 0.0, 0.006666666666666667, 0.006666666666666667, 0.013333333333333334, 0.013333333333333334, 0.02, 0.02, 0.02666666666666667, 0.02666666666666667, 0.03333333333333333, 0.03333333333333333, 0.04, 0.04, 0.04666666666666667, 0.04666666666666667, 0.06666666666666667, 0.06666666666666667, 0.07333333333333333, 0.07333333333333333, 0.08, 0.08, 0.08666666666666667, 0.08666666666666667, 0.09333333333333334, 0.09333333333333334, 0.1, 0.1, 0.10666666666666667, 0.10666666666666667, 0.11333333333333333, 0.11333333333333333, 0.12, 0.12, 0.12666666666666668, 0.12666666666666668, 0.13333333333333333, 0.13333333333333333, 0.14, 0.14, 0.14666666666666667, 0.14666666666666667, 0.16, 0.16, 0.16666666666666666, 0.16666666666666666, 0.18, 0.18, 0.19333333333333333, 0.19333333333333333, 0.2, 0.2, 0.20666666666666667, 0.20666666666666667, 0.22, 0.22, 0.22666666666666666, 0.22666666666666666, 0.24666666666666667, 0.24666666666666667, 0.26666666666666666, 0.26666666666666666, 0.29333333333333333, 0.29333333333333333, 0.3, 0.3, 0.30666666666666664, 0.30666666666666664, 0.32666666666666666, 0.32666666666666666, 0.3466666666666667, 0.3466666666666667, 0.37333333333333335, 0.37333333333333335, 0.4066666666666667, 0.4066666666666667, 0.47333333333333333, 0.47333333333333333, 0.5533333333333333, 0.5533333333333333, 0.56, 0.56, 0.5866666666666667, 0.5866666666666667, 0.6466666666666666, 0.6466666666666666, 0.9466666666666667, 0.9466666666666667, 1.0],
        [0.0, 0.006666666666666667, 0.08666666666666667, 0.08666666666666667, 0.13333333333333333, 0.13333333333333333, 0.24, 0.24, 0.3466666666666667, 0.3466666666666667, 0.41333333333333333, 0.41333333333333333, 0.46, 0.46, 0.5, 0.5, 0.52, 0.52, 0.54, 0.54, 0.5666666666666667, 0.5666666666666667, 0.6, 0.6, 0.6066666666666667, 0.6066666666666667, 0.62, 0.62, 0.6333333333333333, 0.6333333333333333, 0.6466666666666666, 0.6466666666666666, 0.6533333333333333, 0.6533333333333333, 0.6733333333333333, 0.6733333333333333, 0.7, 0.7, 0.7466666666666667, 0.7466666666666667, 0.7666666666666667, 0.7666666666666667, 0.7866666666666666, 0.7866666666666666, 0.7933333333333333, 0.7933333333333333, 0.8133333333333334, 0.8133333333333334, 0.82, 0.82, 0.8333333333333334, 0.8333333333333334, 0.8533333333333334, 0.8533333333333334, 0.8666666666666667, 0.8666666666666667, 0.8733333333333333, 0.8733333333333333, 0.88, 0.88, 0.8866666666666667, 0.8866666666666667, 0.9, 0.9, 0.9066666666666666, 0.9066666666666666, 0.92, 0.92, 0.9266666666666666, 0.9266666666666666, 0.9333333333333333, 0.9333333333333333, 0.9466666666666667, 0.9466666666666667, 0.9533333333333334, 0.9533333333333334, 0.96, 0.96, 0.9666666666666667, 0.9666666666666667, 0.9733333333333334, 0.9733333333333334, 0.98, 0.98, 0.9866666666666667, 0.9866666666666667, 0.9933333333333333, 0.9933333333333333, 1.0, 1.0],
        [1.9988279, 0.998828, 0.99757993, 0.99751675, 0.99635065, 0.9958299, 0.993112, 0.9928035, 0.9874129, 0.9871955, 0.985038, 0.9846613, 0.97998, 0.9792686, 0.9748864, 0.9738142, 0.9716509, 0.97049516, 0.96922314, 0.96919876, 0.963744, 0.9629279, 0.9555256, 0.95351917, 0.94816786, 0.94703555, 0.94499147, 0.9425277, 0.93548226, 0.9351236, 0.933316, 0.92924464, 0.928972, 0.9272514, 0.92058975, 0.918377, 0.90655833, 0.906139, 0.8784935, 0.8747413, 0.8585501, 0.8570069, 0.827587, 0.82031137, 0.80586433, 0.7941502, 0.7737209, 0.7611333, 0.75667757, 0.727729, 0.7120627, 0.70689243, 0.6839695, 0.67700166, 0.6193173, 0.5840258, 0.57494825, 0.5633254, 0.55645275, 0.5233106, 0.4892572, 0.45903182, 0.44265723, 0.3789649, 0.3777106, 0.37323996, 0.33957335, 0.3364604, 0.31862813, 0.2417617, 0.24121284, 0.19058771, 0.1811915, 0.16181499, 0.1582388, 0.11076637, 0.10971039, 0.088683315, 0.08718039, 0.040167768, 0.039983295, 0.039445195, 0.033844955, 0.027390562, 0.023098504, 0.012854396, 0.012775614, 0.00045716861, 0.00035803416, 0.000102014914],
        0.8930222222222223),
      BackboneInfo(
        "Mobile-Net+Conv3D",
        [0.0, 0.0, 0.0, 0.006666666666666667, 0.006666666666666667, 0.013333333333333334, 0.013333333333333334, 0.02, 0.02, 0.02666666666666667, 0.02666666666666667, 0.03333333333333333, 0.03333333333333333, 0.04666666666666667, 0.04666666666666667, 0.05333333333333334, 0.05333333333333334, 0.06, 0.06, 0.06666666666666667, 0.06666666666666667, 0.07333333333333333, 0.07333333333333333, 0.08, 0.08, 0.08666666666666667, 0.08666666666666667, 0.09333333333333334, 0.09333333333333334, 0.10666666666666667, 0.10666666666666667, 0.12, 0.12, 0.12666666666666668, 0.12666666666666668, 0.13333333333333333, 0.13333333333333333, 0.17333333333333334, 0.17333333333333334, 0.32, 0.32, 0.3333333333333333, 0.3333333333333333, 1.0],
        [0.0, 0.006666666666666667, 0.44666666666666666, 0.44666666666666666, 0.5066666666666667, 0.5066666666666667, 0.5666666666666667, 0.5666666666666667, 0.64, 0.64, 0.6733333333333333, 0.6733333333333333, 0.74, 0.74, 0.78, 0.78, 0.8066666666666666, 0.8066666666666666, 0.84, 0.84, 0.8466666666666667, 0.8466666666666667, 0.8533333333333334, 0.8533333333333334, 0.8666666666666667, 0.8666666666666667, 0.9266666666666666, 0.9266666666666666, 0.9333333333333333, 0.9333333333333333, 0.9466666666666667, 0.9466666666666667, 0.9533333333333334, 0.9533333333333334, 0.96, 0.96, 0.9666666666666667, 0.9666666666666667, 0.9866666666666667, 0.9866666666666667, 0.9933333333333333, 0.9933333333333333, 1.0, 1.0],
        [1.9994907, 0.99949074, 0.99582654, 0.99577725, 0.9943914, 0.99433005, 0.9928334, 0.9923517, 0.9869206, 0.9863645, 0.98202884, 0.98141956, 0.967671, 0.9645981, 0.9499963, 0.94992304, 0.92982906, 0.9105394, 0.85009825, 0.84642583, 0.8369898, 0.8346322, 0.80909795, 0.8080423, 0.79881674, 0.789622, 0.6727745, 0.6684461, 0.62292093, 0.5607123, 0.53120553, 0.4750683, 0.43114704, 0.41924676, 0.35063538, 0.27624458, 0.24640918, 0.17664781, 0.12851205, 0.020146534, 0.019706698, 0.015233321, 0.015178525, 0.00020845671],
        0.9693333333333334),
      BackboneInfo(
        "Mobile-Net+ConvLSTM",
        [0.0, 0.0, 0.0, 0.006666666666666667, 0.006666666666666667, 0.013333333333333334, 0.013333333333333334, 0.02, 0.02, 0.02666666666666667, 0.02666666666666667, 0.03333333333333333, 0.03333333333333333, 0.04, 0.04, 0.04666666666666667, 0.04666666666666667, 0.05333333333333334, 0.05333333333333334, 0.06, 0.06, 0.07333333333333333, 0.07333333333333333, 0.08666666666666667, 0.08666666666666667, 0.1, 0.1, 0.10666666666666667, 0.10666666666666667, 0.12, 0.12, 0.13333333333333333, 0.13333333333333333, 0.14666666666666667, 0.14666666666666667, 0.15333333333333332, 0.15333333333333332, 0.16666666666666666, 0.16666666666666666, 0.18, 0.18, 0.18666666666666668, 0.18666666666666668, 0.19333333333333333, 0.19333333333333333, 0.2, 0.2, 0.20666666666666667, 0.20666666666666667, 0.21333333333333335, 0.21333333333333335, 0.23333333333333334, 0.23333333333333334, 0.24, 0.24, 0.24666666666666667, 0.24666666666666667, 0.2733333333333333, 0.2733333333333333, 0.28, 0.28, 0.31333333333333335, 0.31333333333333335, 0.32666666666666666, 0.32666666666666666, 0.34, 0.34, 0.36, 0.36, 0.36666666666666664, 0.36666666666666664, 0.42, 0.42, 0.43333333333333335, 0.43333333333333335, 0.44666666666666666, 0.44666666666666666, 0.46, 0.46, 0.4666666666666667, 0.4666666666666667, 0.5, 0.5, 0.5066666666666667, 0.5066666666666667, 0.5133333333333333, 0.5133333333333333, 0.5266666666666666, 0.5266666666666666, 0.5466666666666666, 0.5466666666666666, 0.56, 0.56, 0.5733333333333334, 0.5733333333333334, 0.6266666666666667, 0.6266666666666667, 0.66, 0.66, 0.68, 0.68, 0.7133333333333334, 0.7133333333333334, 0.7533333333333333, 0.7533333333333333, 0.76, 0.76, 0.78, 0.78, 0.8066666666666666, 0.8066666666666666, 0.8266666666666667, 0.8266666666666667, 0.8933333333333333, 0.8933333333333333, 0.9133333333333333, 0.9133333333333333, 0.9266666666666666, 0.9266666666666666, 1.0],
        [0.0, 0.006666666666666667, 0.07333333333333333, 0.07333333333333333, 0.12, 0.12, 0.18666666666666668, 0.18666666666666668, 0.19333333333333333, 0.19333333333333333, 0.26666666666666666, 0.26666666666666666, 0.3, 0.3, 0.30666666666666664, 0.30666666666666664, 0.37333333333333335, 0.37333333333333335, 0.38, 0.38, 0.38666666666666666, 0.38666666666666666, 0.3933333333333333, 0.3933333333333333, 0.4066666666666667, 0.4066666666666667, 0.4533333333333333, 0.4533333333333333, 0.47333333333333333, 0.47333333333333333, 0.4866666666666667, 0.4866666666666667, 0.49333333333333335, 0.49333333333333335, 0.5066666666666667, 0.5066666666666667, 0.5333333333333333, 0.5333333333333333, 0.5466666666666666, 0.5466666666666666, 0.5533333333333333, 0.5533333333333333, 0.5733333333333334, 0.5733333333333334, 0.58, 0.58, 0.5866666666666667, 0.5866666666666667, 0.6, 0.6, 0.6133333333333333, 0.6133333333333333, 0.64, 0.64, 0.6533333333333333, 0.6533333333333333, 0.6666666666666666, 0.6666666666666666, 0.68, 0.68, 0.6866666666666666, 0.6866666666666666, 0.7066666666666667, 0.7066666666666667, 0.7133333333333334, 0.7133333333333334, 0.72, 0.72, 0.74, 0.74, 0.7666666666666667, 0.7666666666666667, 0.7733333333333333, 0.7733333333333333, 0.78, 0.78, 0.7866666666666666, 0.7866666666666666, 0.7933333333333333, 0.7933333333333333, 0.8, 0.8, 0.8066666666666666, 0.8066666666666666, 0.82, 0.82, 0.8266666666666667, 0.8266666666666667, 0.84, 0.84, 0.8533333333333334, 0.8533333333333334, 0.86, 0.86, 0.88, 0.88, 0.9066666666666666, 0.9066666666666666, 0.9133333333333333, 0.9133333333333333, 0.9266666666666666, 0.9266666666666666, 0.9333333333333333, 0.9333333333333333, 0.94, 0.94, 0.9466666666666667, 0.9466666666666667, 0.96, 0.96, 0.9666666666666667, 0.9666666666666667, 0.98, 0.98, 0.9866666666666667, 0.9866666666666667, 0.9933333333333333, 0.9933333333333333, 1.0, 1.0],
        [1.9999484, 0.9999484, 0.992219, 0.99217063, 0.9855994, 0.98246044, 0.968488, 0.9678527, 0.9644974, 0.962005, 0.9375053, 0.9370441, 0.9262187, 0.92507064, 0.9234433, 0.9215339, 0.8867945, 0.88652605, 0.8750981, 0.8725347, 0.8687746, 0.86709285, 0.85912275, 0.85725236, 0.8502203, 0.84420073, 0.8097033, 0.8083615, 0.8009715, 0.79929405, 0.7942682, 0.7928255, 0.7876379, 0.78313595, 0.77655524, 0.77582395, 0.757009, 0.75257075, 0.7375551, 0.7269085, 0.72052336, 0.7199421, 0.69828904, 0.68708736, 0.67892617, 0.6737858, 0.6723649, 0.6690079, 0.66497195, 0.6639739, 0.66191936, 0.65392196, 0.6360528, 0.6237191, 0.6174657, 0.61667544, 0.6039175, 0.5648218, 0.55980504, 0.55898845, 0.55125433, 0.5357003, 0.5268833, 0.52155185, 0.5095624, 0.49753338, 0.4960677, 0.47897142, 0.46870074, 0.46545237, 0.44449192, 0.38806817, 0.38462725, 0.3796681, 0.37766153, 0.3741109, 0.3720209, 0.3699858, 0.34633455, 0.34321854, 0.3415283, 0.30259123, 0.29939958, 0.29418728, 0.29300123, 0.28858712, 0.28086042, 0.2549115, 0.25256902, 0.24805644, 0.23974124, 0.23049082, 0.229247, 0.22724044, 0.21065463, 0.16537353, 0.14881532, 0.14364141, 0.14044587, 0.12413548, 0.117718436, 0.104795866, 0.10280917, 0.0931284, 0.092141315, 0.09169991, 0.09116567, 0.083743356, 0.07731563, 0.06427253, 0.061568856, 0.053331748, 0.046078056, 0.031287845, 0.031080006, 0.024752703, 0.02447474, 0.019727089, 0.017490782, 0.00017055536],
        0.7652888888888889),
      BackboneInfo(
        "Mobile-Net+Bi-ConvLSTM",
        [0.0, 0.0, 0.0, 0.006666666666666667, 0.006666666666666667, 0.013333333333333334, 0.013333333333333334, 0.02, 0.02, 0.02666666666666667, 0.02666666666666667, 0.03333333333333333, 0.03333333333333333, 0.04, 0.04, 0.04666666666666667, 0.04666666666666667, 0.05333333333333334, 0.05333333333333334, 0.06666666666666667, 0.06666666666666667, 0.08, 0.08, 0.08666666666666667, 0.08666666666666667, 0.09333333333333334, 0.09333333333333334, 0.1, 0.1, 0.11333333333333333, 0.11333333333333333, 0.13333333333333333, 0.13333333333333333, 0.2, 0.2, 0.20666666666666667, 0.20666666666666667, 0.21333333333333335, 0.21333333333333335, 0.22666666666666666, 0.22666666666666666, 0.23333333333333334, 0.23333333333333334, 0.26, 0.26, 0.29333333333333333, 0.29333333333333333, 0.30666666666666664, 0.30666666666666664, 0.34, 0.34, 0.3466666666666667, 0.3466666666666667, 0.36, 0.36, 0.4533333333333333, 0.4533333333333333, 0.54, 0.54, 0.6866666666666666, 0.6866666666666666, 0.8333333333333334, 0.8333333333333334, 1.0],
        [0.0, 0.006666666666666667, 0.24666666666666667, 0.24666666666666667, 0.52, 0.52, 0.5533333333333333, 0.5533333333333333, 0.6333333333333333, 0.6333333333333333, 0.6533333333333333, 0.6533333333333333, 0.66, 0.66, 0.68, 0.68, 0.7133333333333334, 0.7133333333333334, 0.7733333333333333, 0.7733333333333333, 0.78, 0.78, 0.7866666666666666, 0.7866666666666666, 0.7933333333333333, 0.7933333333333333, 0.8266666666666667, 0.8266666666666667, 0.8333333333333334, 0.8333333333333334, 0.86, 0.86, 0.88, 0.88, 0.8866666666666667, 0.8866666666666667, 0.8933333333333333, 0.8933333333333333, 0.9, 0.9, 0.9066666666666666, 0.9066666666666666, 0.9133333333333333, 0.9133333333333333, 0.92, 0.92, 0.9333333333333333, 0.9333333333333333, 0.94, 0.94, 0.9466666666666667, 0.9466666666666667, 0.9533333333333334, 0.9533333333333334, 0.9733333333333334, 0.9733333333333334, 0.98, 0.98, 0.9866666666666667, 0.9866666666666667, 0.9933333333333333, 0.9933333333333333, 1.0, 1.0],
        [1.9994273, 0.9994273, 0.99186194, 0.99183273, 0.9681986, 0.96759796, 0.96323085, 0.96290356, 0.9342201, 0.93382925, 0.92762566, 0.92734635, 0.92483044, 0.92451143, 0.9049483, 0.89610505, 0.8842564, 0.8794496, 0.8507419, 0.826427, 0.8247182, 0.8083685, 0.8062744, 0.7867907, 0.7825591, 0.77016824, 0.7531689, 0.74494064, 0.7439685, 0.7245101, 0.6732522, 0.6529905, 0.6037799, 0.46475816, 0.44263875, 0.4331492, 0.42822897, 0.42396274, 0.42274937, 0.40976903, 0.40848726, 0.4043911, 0.39411998, 0.32693985, 0.32510617, 0.252751, 0.23992953, 0.23205467, 0.21889016, 0.1457685, 0.13206625, 0.12068095, 0.11972338, 0.11261301, 0.082171485, 0.041686095, 0.038154975, 0.0218743, 0.02126515, 0.008346598, 0.0072840415, 0.0034290173, 0.0033675549, 0.0004128105],
        0.9353777777777778),
      BackboneInfo(
        "Mobile-Net+TAConv3D",
        [0.0, 0.0, 0.0, 0.0, 0.0, 0.006666666666666667, 0.006666666666666667, 0.013333333333333334, 0.013333333333333334, 0.02, 0.02, 0.02666666666666667, 0.02666666666666667, 0.03333333333333333, 0.03333333333333333, 0.04, 0.04, 0.04666666666666667, 0.04666666666666667, 0.05333333333333334, 0.05333333333333334, 0.06, 0.06, 0.06666666666666667, 0.06666666666666667, 0.07333333333333333, 0.07333333333333333, 0.08, 0.08, 0.08666666666666667, 0.08666666666666667, 0.09333333333333334, 0.09333333333333334, 0.10666666666666667, 0.10666666666666667, 0.11333333333333333, 0.11333333333333333, 0.12666666666666668, 0.12666666666666668, 0.16, 0.16, 0.18, 0.18, 0.24666666666666667, 0.24666666666666667, 0.3, 0.3, 0.56, 0.56, 1.0],
        [0.0, 0.006666666666666667, 0.22, 0.23333333333333334, 0.3466666666666667, 0.3466666666666667, 0.47333333333333333, 0.47333333333333333, 0.49333333333333335, 0.49333333333333335, 0.5466666666666666, 0.5466666666666666, 0.5866666666666667, 0.5866666666666667, 0.6733333333333333, 0.6733333333333333, 0.68, 0.68, 0.74, 0.74, 0.8, 0.8, 0.8333333333333334, 0.8333333333333334, 0.84, 0.84, 0.86, 0.86, 0.88, 0.88, 0.92, 0.92, 0.94, 0.94, 0.9533333333333334, 0.9533333333333334, 0.96, 0.96, 0.9666666666666667, 0.9666666666666667, 0.9733333333333334, 0.9733333333333334, 0.98, 0.98, 0.9866666666666667, 0.9866666666666667, 0.9933333333333333, 0.9933333333333333, 1.0, 1.0],
        [1.9999639, 0.9999639, 0.99991524, 0.99991274, 0.9998715, 0.9998667, 0.9997503, 0.9997271, 0.9997018, 0.99966156, 0.9995297, 0.9995254, 0.9993381, 0.9993318, 0.99862885, 0.998514, 0.99840826, 0.99748755, 0.99585587, 0.9957973, 0.99152476, 0.99035347, 0.9606602, 0.96022475, 0.9564283, 0.9530917, 0.8733009, 0.841044, 0.8070975, 0.7668107, 0.64118135, 0.4586452, 0.23874067, 0.209419, 0.1338726, 0.13112155, 0.12787603, 0.121487245, 0.10537791, 0.059427567, 0.056460243, 0.03407157, 0.027537068, 0.006503598, 0.0051976605, 0.0015334805, 0.001490287, 0.00021793638, 0.00020731204, 3.5722685e-05],
        0.9640888888888888),
      # BackboneInfo(
      #   "VGG16",
      #   [0.0, 0.0, 0.0, 0.05, 0.05, 0.1, 0.1, 0.15, 0.15, 0.2, 0.2, 0.35, 0.35, 0.45, 0.45, 0.55, 0.55, 0.6, 0.6, 0.85, 0.85, 0.95, 0.95, 1.0],
      #   [0.0, 0.05, 0.1, 0.1, 0.2, 0.2, 0.25, 0.25, 0.55, 0.55, 0.6, 0.6, 0.65, 0.65, 0.75, 0.75, 0.85, 0.85, 0.9, 0.9, 0.95, 0.95, 1.0, 1.0],
      #   [1.9997065, 0.99970657, 0.99907494, 0.9975224, 0.98854095, 0.9735544, 0.9681248, 0.96675146, 0.7234127, 0.70866615, 0.6051965, 0.37994248, 0.3031942, 0.17219435, 0.16303243, 0.14421186, 0.12106655, 0.11884453, 0.11483465, 0.032621495, 0.030867983, 0.007962798, 0.003395897, 0.0028513789],
      #   0.6975),
      # BackboneInfo(
      #   "Res-Net 152v2",
      #   [0.0, 0.0, 0.0, 0.15, 0.15, 0.2, 0.2, 0.4, 0.4, 0.55, 0.55, 0.65, 0.65, 0.9, 0.9, 1.0],
      #   [0.0, 0.05, 0.4, 0.4, 0.55, 0.55, 0.8, 0.8, 0.85, 0.85, 0.9, 0.9, 0.95, 0.95, 1.0, 1.0],
      #   [1.9989109, 0.9989109, 0.9841965, 0.976777, 0.96500534, 0.95343566, 0.7937314, 0.4124024, 0.36704403, 0.12566145, 0.11843777, 0.08121345, 0.034633785, 0.0141533045, 0.013751157, 0.0018344162],
      #   0.8025),
      BackboneInfo(
        "Dense-Net121+Conv3D",
        [0.0, 0.0, 0.0, 0.006666666666666667, 0.006666666666666667, 0.013333333333333334, 0.013333333333333334, 0.02, 0.02, 0.02666666666666667, 0.02666666666666667, 0.04, 0.04, 0.04666666666666667, 0.04666666666666667, 0.05333333333333334, 0.05333333333333334, 0.06, 0.06, 0.06666666666666667, 0.06666666666666667, 0.08, 0.08, 0.08666666666666667, 0.08666666666666667, 0.09333333333333334, 0.09333333333333334, 0.1, 0.1, 0.12, 0.12, 0.12666666666666668, 0.12666666666666668, 0.14, 0.14, 0.17333333333333334, 0.17333333333333334, 0.18666666666666668, 0.18666666666666668, 0.2, 0.2, 0.2733333333333333, 0.2733333333333333, 0.32, 0.32, 0.36666666666666664, 0.36666666666666664, 0.6333333333333333, 0.6333333333333333, 0.6666666666666666, 0.6666666666666666, 1.0],
        [0.0, 0.006666666666666667, 0.19333333333333333, 0.19333333333333333, 0.37333333333333335, 0.37333333333333335, 0.64, 0.64, 0.7333333333333333, 0.7333333333333333, 0.7666666666666667, 0.7666666666666667, 0.7933333333333333, 0.7933333333333333, 0.8066666666666666, 0.8066666666666666, 0.8133333333333334, 0.8133333333333334, 0.82, 0.82, 0.8333333333333334, 0.8333333333333334, 0.84, 0.84, 0.8666666666666667, 0.8666666666666667, 0.8933333333333333, 0.8933333333333333, 0.9, 0.9, 0.9066666666666666, 0.9066666666666666, 0.9133333333333333, 0.9133333333333333, 0.94, 0.94, 0.9466666666666667, 0.9466666666666667, 0.96, 0.96, 0.9666666666666667, 0.9666666666666667, 0.9733333333333334, 0.9733333333333334, 0.98, 0.98, 0.9866666666666667, 0.9866666666666667, 0.9933333333333333, 0.9933333333333333, 1.0, 1.0],
        [1.9997964, 0.99979633, 0.9996449, 0.99964225, 0.99929035, 0.9992873, 0.9956558, 0.99555606, 0.98736227, 0.9871573, 0.98163766, 0.98111665, 0.97969455, 0.9782242, 0.9718927, 0.94720066, 0.9433092, 0.9317793, 0.9307166, 0.88883156, 0.86222476, 0.84145236, 0.8353363, 0.82905114, 0.7576242, 0.7523865, 0.64727426, 0.6395062, 0.61341715, 0.5819473, 0.4509949, 0.4354322, 0.35281, 0.2898424, 0.15790142, 0.10421615, 0.10198219, 0.06374682, 0.05252678, 0.04720482, 0.042246036, 0.015648607, 0.0154377725, 0.008819355, 0.008519028, 0.006404677, 0.006265323, 0.00088734354, 0.0008732574, 0.00079653715, 0.000773797, 0.00020079903],
        0.9577333333333333),
      BackboneInfo(
        "Dense-Net121+Bi-ConvLSTM",
        [0.0, 0.0, 0.0, 0.006666666666666667, 0.006666666666666667, 0.013333333333333334, 0.013333333333333334, 0.02, 0.02, 0.02666666666666667, 0.02666666666666667, 0.03333333333333333, 0.03333333333333333, 0.04, 0.04, 0.04666666666666667, 0.04666666666666667, 0.06, 0.06, 0.06666666666666667, 0.06666666666666667, 0.07333333333333333, 0.07333333333333333, 0.08, 0.08, 0.08666666666666667, 0.08666666666666667, 0.09333333333333334, 0.09333333333333334, 0.10666666666666667, 0.10666666666666667, 0.13333333333333333, 0.13333333333333333, 0.16666666666666666, 0.16666666666666666, 0.17333333333333334, 0.17333333333333334, 0.26666666666666666, 0.26666666666666666, 0.28, 0.28, 0.3, 0.3, 0.31333333333333335, 0.31333333333333335, 0.4266666666666667, 0.4266666666666667, 1.0],
        [0.0, 0.006666666666666667, 0.29333333333333333, 0.29333333333333333, 0.3466666666666667, 0.3466666666666667, 0.37333333333333335, 0.37333333333333335, 0.41333333333333333, 0.41333333333333333, 0.42, 0.42, 0.5933333333333334, 0.5933333333333334, 0.64, 0.64, 0.74, 0.74, 0.7733333333333333, 0.7733333333333333, 0.7933333333333333, 0.7933333333333333, 0.8066666666666666, 0.8066666666666666, 0.8466666666666667, 0.8466666666666667, 0.86, 0.86, 0.9066666666666666, 0.9066666666666666, 0.9333333333333333, 0.9333333333333333, 0.9466666666666667, 0.9466666666666667, 0.96, 0.96, 0.9666666666666667, 0.9666666666666667, 0.9733333333333334, 0.9733333333333334, 0.98, 0.98, 0.9866666666666667, 0.9866666666666667, 0.9933333333333333, 0.9933333333333333, 1.0, 1.0],
        [1.9999564, 0.99995637, 0.99941015, 0.99938035, 0.9990941, 0.9990701, 0.99890697, 0.9988907, 0.99844605, 0.9981713, 0.9977888, 0.99778396, 0.99336314, 0.9930443, 0.98895127, 0.9881125, 0.96465445, 0.9610994, 0.9470365, 0.945754, 0.94337815, 0.9330926, 0.9233869, 0.91451466, 0.85902554, 0.82090557, 0.81346875, 0.81208473, 0.52884424, 0.4818747, 0.4163558, 0.34941027, 0.3006026, 0.20656525, 0.16928262, 0.16084842, 0.1172507, 0.025479747, 0.022311265, 0.021167452, 0.019780295, 0.013323487, 0.013252757, 0.012204885, 0.010670487, 0.0027163427, 0.002623591, 5.026586e-05],
        0.9543999999999999),
      BackboneInfo(
        "Inceptionv3+Conv3D",
        [0.0, 0.0, 0.0, 0.006666666666666667, 0.006666666666666667, 0.013333333333333334, 0.013333333333333334, 0.02, 0.02, 0.02666666666666667, 0.02666666666666667, 0.04, 0.04, 0.05333333333333334, 0.05333333333333334, 0.06, 0.06, 0.06666666666666667, 0.06666666666666667, 0.07333333333333333, 0.07333333333333333, 0.08, 0.08, 0.08666666666666667, 0.08666666666666667, 0.1, 0.1, 0.12, 0.12, 0.12666666666666668, 0.12666666666666668, 0.14666666666666667, 0.14666666666666667, 0.15333333333333332, 0.15333333333333332, 0.16666666666666666, 0.16666666666666666, 0.17333333333333334, 0.17333333333333334, 0.18, 0.18, 0.18666666666666668, 0.18666666666666668, 0.19333333333333333, 0.19333333333333333, 0.2, 0.2, 0.22, 0.22, 0.22666666666666666, 0.22666666666666666, 0.24, 0.24, 0.24666666666666667, 0.24666666666666667, 0.28, 0.28, 0.34, 0.34, 0.38, 0.38, 0.42, 0.42, 0.5933333333333334, 0.5933333333333334, 0.94, 0.94, 1.0],
        [0.0, 0.006666666666666667, 0.30666666666666664, 0.30666666666666664, 0.42, 0.42, 0.5333333333333333, 0.5333333333333333, 0.6466666666666666, 0.6466666666666666, 0.66, 0.66, 0.6866666666666666, 0.6866666666666666, 0.6933333333333334, 0.6933333333333334, 0.72, 0.72, 0.74, 0.74, 0.7533333333333333, 0.7533333333333333, 0.7666666666666667, 0.7666666666666667, 0.7733333333333333, 0.7733333333333333, 0.8, 0.8, 0.82, 0.82, 0.84, 0.84, 0.8466666666666667, 0.8466666666666667, 0.8533333333333334, 0.8533333333333334, 0.86, 0.86, 0.8666666666666667, 0.8666666666666667, 0.8866666666666667, 0.8866666666666667, 0.8933333333333333, 0.8933333333333333, 0.9, 0.9, 0.9066666666666666, 0.9066666666666666, 0.9133333333333333, 0.9133333333333333, 0.92, 0.92, 0.9266666666666666, 0.9266666666666666, 0.9333333333333333, 0.9333333333333333, 0.94, 0.94, 0.9666666666666667, 0.9666666666666667, 0.98, 0.98, 0.9866666666666667, 0.9866666666666667, 0.9933333333333333, 0.9933333333333333, 1.0, 1.0],
        [1.9987627, 0.9987627, 0.99658656, 0.9964263, 0.99520963, 0.9949522, 0.9935551, 0.99348986, 0.9894326, 0.9892709, 0.98847467, 0.98562104, 0.98233, 0.9821745, 0.98003805, 0.97888845, 0.973679, 0.9719449, 0.95174986, 0.9461237, 0.93785423, 0.92517644, 0.91747975, 0.9160133, 0.90985805, 0.8995497, 0.8865865, 0.87691957, 0.8101089, 0.802451, 0.782494, 0.7447761, 0.7359994, 0.73261404, 0.7267521, 0.70226383, 0.6897098, 0.63852704, 0.605163, 0.5989419, 0.54661727, 0.5382088, 0.5162482, 0.5144848, 0.4451003, 0.43716615, 0.4112168, 0.3507816, 0.31861663, 0.29366714, 0.27002805, 0.1526295, 0.15131794, 0.14705133, 0.13763162, 0.122992024, 0.11989155, 0.057254944, 0.050611768, 0.035427094, 0.03301278, 0.026444227, 0.026416754, 0.008552987, 0.008544629, 0.0006004634, 0.00056016434, 0.00041524076],
        0.9335555555555555),
      BackboneInfo(
        "Inceptionv3+ConvLSTM",
        [0.0, 0.0, 0.0, 0.006666666666666667, 0.006666666666666667, 0.013333333333333334, 0.013333333333333334, 0.02, 0.02, 0.02666666666666667, 0.02666666666666667, 0.03333333333333333, 0.03333333333333333, 0.04, 0.04, 0.04666666666666667, 0.04666666666666667, 0.06666666666666667, 0.06666666666666667, 0.08, 0.08, 0.08666666666666667, 0.08666666666666667, 0.09333333333333334, 0.09333333333333334, 0.1, 0.1, 0.12, 0.12, 0.12666666666666668, 0.12666666666666668, 0.13333333333333333, 0.13333333333333333, 0.14666666666666667, 0.14666666666666667, 0.17333333333333334, 0.17333333333333334, 0.18666666666666668, 0.18666666666666668, 0.19333333333333333, 0.19333333333333333, 0.20666666666666667, 0.20666666666666667, 0.21333333333333335, 0.21333333333333335, 0.22666666666666666, 0.22666666666666666, 0.23333333333333334, 0.23333333333333334, 0.28, 0.28, 0.29333333333333333, 0.29333333333333333, 0.3, 0.3, 0.31333333333333335, 0.31333333333333335, 0.3333333333333333, 0.3333333333333333, 0.38, 0.38, 0.5, 0.5, 0.5266666666666666, 0.5266666666666666, 0.66, 0.66, 0.78, 0.78, 0.9333333333333333, 0.9333333333333333, 1.0],
        [0.0, 0.006666666666666667, 0.16, 0.16, 0.18666666666666668, 0.18666666666666668, 0.19333333333333333, 0.19333333333333333, 0.2, 0.2, 0.4866666666666667, 0.4866666666666667, 0.49333333333333335, 0.49333333333333335, 0.5933333333333334, 0.5933333333333334, 0.7066666666666667, 0.7066666666666667, 0.7333333333333333, 0.7333333333333333, 0.7466666666666667, 0.7466666666666667, 0.76, 0.76, 0.78, 0.78, 0.7933333333333333, 0.7933333333333333, 0.8, 0.8, 0.8066666666666666, 0.8066666666666666, 0.8333333333333334, 0.8333333333333334, 0.8466666666666667, 0.8466666666666667, 0.86, 0.86, 0.8666666666666667, 0.8666666666666667, 0.8733333333333333, 0.8733333333333333, 0.8866666666666667, 0.8866666666666667, 0.8933333333333333, 0.8933333333333333, 0.9, 0.9, 0.9066666666666666, 0.9066666666666666, 0.92, 0.92, 0.9266666666666666, 0.9266666666666666, 0.9333333333333333, 0.9333333333333333, 0.9533333333333334, 0.9533333333333334, 0.96, 0.96, 0.9666666666666667, 0.9666666666666667, 0.9733333333333334, 0.9733333333333334, 0.98, 0.98, 0.9866666666666667, 0.9866666666666667, 0.9933333333333333, 0.9933333333333333, 1.0, 1.0],
        [1.9999185, 0.99991846, 0.99974114, 0.99973756, 0.99971455, 0.99971193, 0.99970776, 0.999706, 0.9997042, 0.99968886, 0.99858713, 0.9985684, 0.99838376, 0.99838114, 0.99629706, 0.9962077, 0.98196906, 0.9514275, 0.92141366, 0.91416556, 0.9102013, 0.9053951, 0.89314, 0.8777932, 0.84945744, 0.8442942, 0.78247344, 0.7309546, 0.7187675, 0.68184096, 0.65459645, 0.6345691, 0.460609, 0.44165492, 0.34513232, 0.27967265, 0.27483386, 0.22911441, 0.20989649, 0.19941342, 0.19824626, 0.1744689, 0.16146863, 0.13517062, 0.11437487, 0.093083985, 0.07954338, 0.052934136, 0.05003412, 0.032947168, 0.022690386, 0.0176363, 0.016372573, 0.015399603, 0.014372612, 0.007889323, 0.006657207, 0.0047618076, 0.00397868, 0.002456725, 0.002329413, 0.0008402482, 0.000757394, 0.0005451337, 0.00050964765, 0.00022787096, 0.00022773215, 0.00014876343, 0.00014650839, 6.521907e-05, 5.9090715e-05, 3.2422915e-05],
        0.9146222222222222),
    ]
  }
}
